# dn-program

Implements a fault proof program that runs through the rollup state-transition to verify an L2 output from L1 inputs.
This verifiable output can then resolve a disputed output on L1.

The program is designed such that it can be run in a deterministic way such that two invocations with the same input
data will result in not only the same output, but the same program execution trace. This allows it to be run in an
on-chain VM as part of the dispute resolution process.

## Compiling

To build dn-program, from within the `dn-program` directory run:

```shell
make dn-program
```

This resulting executable will be in `./bin/dn-program`

## Testing

To run dn-program unit tests, from within the `dn-program` directory run:

```shell
make test
```

## Running

From within the `dn-program` directory, options can be reviewed with:

```shell
./bin/dn-program --help
```

## Generating the Absolute Prestate

The absolute pre-state of the dn-program can be generated by executing the makefile
`reproducible-prestate` target. Effectively, this builds a docker image specified
by [Dockerfile.repro](./Dockerfile.repro) pinned with the following dependencies:
- golang version `1.22.7`
- alpine `3.20`

After running `make reproducible-prestate`, the following files can be found in
[./bin/](./bin/):
- [`dn-program`](./bin/dn-program)
- [`dn-program-client.elf`](./bin/dn-program-client.elf)
- [`dn-program-client64.elf`](./bin/dn-program-client64.elf)
- [`prestate.bin.gz`](./bin/prestate.bin.gz)
- [`prestate-proof.json`](./bin/prestate-proof.json)

The `prestate-proof.json` file is what contains the absolute pre-state hash under
the `.pre` key that is also used by the [contracts][ctb] deploy script.

[ctb]: ../packages/contracts-dn-chain/
